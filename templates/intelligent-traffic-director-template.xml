<config-template xmlns="http://tail-f.com/ns/config/1.0"
                 servicepoint="intelligent-traffic-director">
  <devices xmlns="http://tail-f.com/ns/ncs">
    <device>
    <name>{/sides/devices}</name>
      <config>
        <feature xmlns="http://tail-f.com/ned/cisco-nx">
          <itd/>
        </feature>
        <itd xmlns="http://tail-f.com/ned/cisco-nx">
          <device-group>
            <group-name>{string(../../service-name)}</group-name>
            <node>
              <ip>
                <address>{../node-ip}</address>
              </ip>
            </node>
          </device-group>
          <service>
            <name>{string(../../service-name)}</name>
            <device-group>{string(../../service-name)}</device-group>
            <ingress>
              <interface>
                <name>{string(../ingress-interface)}</name>
              </interface>
            </ingress>
            <load-balance>
              <method>
                <method>src</method>
                <ip/>
              </method>
              <buckets>{string(../buckets)}</buckets>
            </load-balance>
            <virtual>
              <ip>
                <address>{string(../virtual-ip)}</address>
                <mask>{string(../virtual-ip-mask)}</mask>
                <advertise>enable</advertise>
              </ip>
            </virtual>
          </service>
        </itd>
      </config>
    </device>
  </devices>
</config-template>
